var wsInit;import{log}from"/js/ksk-lib.js";export var ws_handlers=new Map;export var ws=new WebSocket("wss://test.agometra.ru/ws");(wsInit=function(){if(3===ws.readyState)try{ws=new WebSocket("wss://test.agometra.ru/ws")}catch(e){log(e)}ws.onopen=function(e){log("WebSocket conne—Åted")},ws.onmessage=function(e){var s;"id"===(s=JSON.parse(e.data)).type?ws.id=s.data:ws_handlers.has(s.type)&&ws_handlers.get(s.type)(s.data)},ws.onclose=function(e){log("WebSocket closed"),setTimeout(wsInit,500)},ws.onerror=function(e){log("WebSocket error: "+e.message),setTimeout(wsInit,500)}})();